<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Aplikaèní doplòky</title>
<meta http-equiv="Content-Script-Type" content="text/javascript">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1250">
<link rel="stylesheet" type="text/css" href="../css/styles_standard.css">
</head>
<body>

  <div id="topictop">&nbsp;</div>
  <div id="topictitleleft">
    <div id="topictitle">
      <h3>Aplikaèní doplòky</h3>
    </div>
  </div>
  
  <div id="main">
    <img src="../img/phe.jpg" style="float:left; margin-right:12px; margin-bottom:24px;" />
    <p>
      Precision Helper má implementovány dva typy rozhraní pro použití aplikaèních doplòkù (funkèních rozšíøení).      
      Jedná se o rozhraní <b>pøíkazové øádky</b> a rozhraní skriptovacího jazyka <b>Pascal Script</b>.
    </p>
    <p>
      Doplòky mohou podstatnì rozšíøit funkènost produktu v rùzných oblastech a mohou být vytváøeny tøetími stranami.           
    </p>
    <p class="big">
      První dostupné doplòky:
    </p>    
    <ul class="shr">
      <li><b>HTML Tidy</b> - doplnìk využívající známý nástroj pro kontrolu, proèištìní zdrojového textu a konverzi témat</li>
      <li><b>Nový projekt ze souborù</b> - prùvodce pro vytvoøení nového projektu nápovìdy z již existujících souborù témat</li>
      <li><b>Upravit HHC</b> - editace zdrojového souboru obsahu v externím HTML editoru</li>
      <li><b>Upravit HHK</b> - editace zdrojového souboru rejstøíku v externím HTML editoru</li>
      <li><b>Statistiky projektu</b> - zobrazení struèných statistických informací o aktuálním projektu</li>
      <li><b>Datum a èas</b> - vložení aktuálního data a èasu do editovaného tématu</li>
    </ul>
    <br />
    

    <p class="big">
      Umístìní doplòkù
    </p>
    <p>
      Všechny aplikaèní doplòky musí být instalovány do aplikaèní složky produktu Precision Helper, do podsložky <i>Extras</i>.
    </p>
    <p style="margin-left:24px; text-align:left;">
      Pøi výchozí instalaci na Windows 2000/XP je to složka:<br>
      <i>"C:\Documents and Settings\%UserName%\Data aplikací\Precision\precisionhelper\Extras"</i><br><br>
      Pøi výchozí instalaci na Windows Vista (a vyšší) je to složka:<br>
      <i>"C:\Users\%UserName%\AppData\Roaming\Precision\precisionhelper\Extras"</i>
    </p>
    <p>
      Každý doplnìk by mìl také být uložen ve zvláštní složce. Sadu doplòkù, která využívá spoleèné souèásti (soubory),
      mùžete samozøejmì umístit do spoleèné složky. 
    </p>
    <br />
    
    <p class="big">
      Konfiguraèní soubory doplòkù
    </p>
    <p>
      Každý doplnìk je definován parametry uvedenými v <b>konfiguraèním souboru</b>, který musí mít pøíponu <b>.PHE</b>
      (napø. MyExtension.phe).<br />
      Konfiguraèní soubory pro doplòky s rozhraním Pascal Script jsou jednoduché a obsahují v podstatì jen popisné informace.
      Naopak konfiguraèní soubory pro doplòky s rozhraním pøíkazové øádky obsahují úplnou definici parametrù
      a jednotlivých operací, které má Precision Helper provést v rámci jednotlivých krokù pøed spuštìním
      a po dokonèení bìhu doplòku.         
    </p>
    <br />

    <p class="big">
      Rozhraní Pascal Script
    </p>
    <p>
      Následující pøíklad ukazuje konfiguraèní soubor doplòku s rozhraním <b>Pascal Script</b>.
    </p>

<pre style="color:#000;background-color:#eee;margin-top:0px;">

  <b>[Precision Helper Extension]</b>
  <b>Interface=</b>pascalscript

  ; Default title and description of the extension   
  <b>Caption=</b>New from files
  <b>Hint=</b>Create a new help project from an existing topic files

  ; Localized title and description of the extension
  <b>Caption.cs=</b>Nový ze souborù
  <b>Hint.cs=</b>Vytvoøit nový projekt nápovìdy z existujících souborù témat
   
  <b>[IDE]</b>
  ; Parts of the Precision Helper IDE, where the extension should be available
  ribbonHOME=1
  ribbonTOC=0
  ribbonIDX=0
  ribbonPUB=0
  ribbonTOOLS=1
  ribbonHELP=0
  TopicSource=0
  
</pre>
    <p>
      Význam parametrù v tomto konfiguraèním souboru je více ménì jasný. Veškerý funkèní kód doplòku tohoto typu
      je umístìn v souboru s názvem <b>RunScript.pas</b>. Pokud doplnìk obsahuje také vizuální prostøedí (formuláø),
      musí být definováno v souboru <b>RunScript.dfm</b>.
    </p>
    <p>
      Pro editaci a vytváøení doplòkù s rozhraním Pascal Script mùžete použít libovolný editor,
      ale doporuèujeme použít produkt <b>pdScript IDE</b>, který je rovnìž dodáván výrobcem produktu Precision Helper,
      a který obsahuje podporu pro veškeré funkce a možnosti implementované do Precision Helperu 
      (viz <a href="http://www.be-precision.com/products/pdscript/" target="blank">http://www.be-precision.com/products/pdscript/</a>).    
    </p>
    <p>
      Jako úvodní pøíklady pro vytváøení Vašich vlastních doplòkù mùžete použít pøeddefinované existující doplòky,
      které naleznete ve výše zmínìné složce. 
    </p>
    <br />

    <p class="big">
      Rozhraní pøíkazové øádky
    </p>
    <p>
      Následující pøíklad ukazuje konfiguraèní soubor doplòku s rozhraním <b>pøíkazové øádky</b>, vèetnì popisu významu parametrù.
    </p>
       
<pre style="color:#000;background-color:#eee;margin-top:0px;">

  <b>[Precision Helper Extension]</b>
  ; Interface: 
  ;   pascalscript - Pascal Script interface  
  ;   cmdline      - Command-line interface
  ;                  An external program is executed with the specified parameters.
  ;                  (See 'Application' and 'Command-line' sections for more info)
  <b>Interface=</b>cmdline
  
  <b>Caption=</b>Edit HHC
  <b>Hint=</b>Open the table of contents source file in an external html editor
  
  <b>Caption.cs=</b>Upravit HHC
  <b>Hint.cs=</b>Otevøít zdrojový soubor obsahu v externím html editoru
  
  <b>[Script]</b>
  ; not implemented yet
  <b>ExecOnLoad=</b>0
  
  <b>[Application]</b>
  ; Application to execute. Can be an exact path, or path with an environment variables, 
  ; or can contain one of the following macros:
  ; %X% - Macro that runs one of the tools predefined in Precision Helper. 
  ;       (X can be: 1 - Html editor, 2 - Web browser, 4 - Image editor, 5 - File manager)
  ; %ENVIRONMENT_VARIABLE% - Any environment variable
  ; %REG:HKxx\KeyPath,ValueName|DefaultValue% - Value from registry
  ; %APPEXTRAS% - Extensions folder of Precision Helper
  ; %APPTEMPLATES% - Templates folder of Precision Helper
  ; %APPFOLDER% - Folder that contains PrecisionHelper.exe file
  ; %APPTEMP% - Temporary folder of Precision Helper (ie. ...\Precision Helper\Temp\...)
  ; %PROJECTFILE% - Current project file
  ; %PROJECTFOLDER% - Folder of the current project
  ; %APPSAMPLES% - Samples folder of Precision Helper  
  <b>%1%</b>
  
  <b>[Command-line]</b>
  ; Command-line parameters. Can contain macros mentioned in [Application] section (except the %X%) and the following macros:
  ; %1 - filename of currently selected item in Precision Helper (topic in TOC, topic in Index, file in Include files section, etc.)
  ; %2 - Source file name of the project (HHP)
  ; %3 - Target CHM file of the project
  ; %4 - Source file name of table of content (HHC)
  ; %5 - Source file name of index of keywords (HHK)
  ; %6 - Current installation folder of this extension
  ; %7 - Current options file name of this extension
  <b>Parameters=</b>"%4"
  
  ; Precision Helper waits until the executed extension will be closed. 
  ; Do not use this when you work with both programs (PH and the application) side by side.
  ; Not available when using the %X% macro in [Application] section
  <b>waitfor=</b>0
  
  ; Saves the TOC before execution
  <b>saveTOC=</b>1
  ; Saves the IDX before execution
  <b>saveIDX=</b>0
  ; Saves the whole project before execution
  <b>saveProject=</b>0
  ; Saves the current topic before execution
  <b>saveTopic=</b>0
  
  ; When the extension is executed, Precision Helper will reload the TOC after its next activation.
  ; If 'waitfor=1' then TOC will be reloaded after closing the extension application
  <b>reloadTOC=</b>1
  ; Similar to reloadTOC, but applies to Index of keywords
  <b>reloadIDX=</b>0
  ; Similar to reloadTOC, but applies to the whole project
  <b>reloadProject=</b>0
  ; Similar to reloadTOC, but applies to the current topic
  <b>reloadTopic=</b>0
  ; Similar to reloadTOC, but reloads all the extensions (suitable for add-ons that implements Add-Ons manager features)  
  <b>reloadExtras=</b>0
  
  <b>[IDE]</b>
  ; Parts of the Precision Helper GUI, where the extension should be available
  ribbonHOME=0
  ribbonTOC=1
  ribbonIDX=0
  ribbonPUB=0
  ribbonTOOLS=0
  ribbonHELP=0
  TopicSource=0
   
</pre>

    <p>
      Jak vidíte z popisu parametrù, tak coby doplnìk mùžete použít skuteènì libovolnou externí aplikaci,
      jelikož Precision Helper není pøímo závislý na jejím bìhu (kromì pøípadného èekání na její dokonèení), ani výstupu. 
    </p>
    <br>

    <p class="big">
      Další možnosti doplòkù
    </p>
    <ul class="shr">
      <li>Ikony doplòkù musí být definovány v souborech s názvem "icon16.png" a "icon24.png",
          které musí být umístìny u konfiguraèního souboru.</li>
      <li>Každému doplòku s rozhraním Pascal Script je vyhrazen soubor s jeho vlastním nastavením,
          který má stejný název jako konfiguraèní soubor, ale pøíponu <b>.PHEINI</b> (viz napø. doplnìk "NewFromFolder")</li>
      <li>Úplný popis syntaxe rozhraní Pascal Script není prozatím k dispozici, ale seznam dostupných funkcí najdete
          ve schématu kódování "Precision Helper" v rámci již zmínìného editoru doplòkù, produktu <b>pdScript IDE</b>
          (viz <a href="http://www.be-precision.com/products/pdscript/" target="blank">http://www.be-precision.com/products/pdscript/</a>).          
          </li>
    </ul>
    <br>


  </div>
  <div id="foot">
    Copyright &copy; 2008-2011&nbsp;&nbsp;Precision software &amp; consulting. All rights reserved.
  </div>
</body>
</html>
